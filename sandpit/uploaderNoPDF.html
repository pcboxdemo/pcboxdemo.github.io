<!doctype html>
<html lang="en">

<head>


	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
	<!-- Box preview SDK -->
	<link rel="stylesheet" href="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/uploader.css">
	<script src="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/uploader.js"></script>

	<script>
		var params = new URLSearchParams(window.location.search);
		var folderId = params.get('folderId');
		var accessToken= params.get('token');
		$(document).ready(function () {
			var contentUploader;
				var testRequestInterceptor = (config)  => {
					var method = config.method;
					//config.data.size=5368709120000;
					//Only do logic when method is post, not options!
					if (method == 'post' && config.url.includes('https://upload.app.box.com/api/2.0/files/content')) {
						var jsonRep = JSON.parse(config.data.attributes);
						//If this is a PDF
						if (jsonRep.name.toLowerCase().endsWith('.pdf')) {
							console.log("drop this download");
							//Use URL that will return a 200
							var diffURL = "https://api.box.com/2.0/users/me";
							config.method = 'get';
							config.url = diffURL;
							//Alert of push a message somewhere on screen so the user can see what happened
							alert('we dont want your pdf files!');
							//$("#myMessageDiv").text("No pdf's please");
						}
					}
					return config;
				};

			contentUploader = new Box.ContentUploader();
			contentUploader.show(folderId, accessToken, {
				container: '.pcontainer',
				requestInterceptor: testRequestInterceptor
			});
		
		});
	</script>
</head>

<body>

	<div class="tab-pane show active mts" role="tabpanel" id="explorer">

		<div style="height:500px" class="pcontainer"></div>
	</div>
</body>

</html>
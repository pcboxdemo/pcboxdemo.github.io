<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <title>Box Platform - Template Application - Preview</title>

    <!-- polyfill.io only loads the polyfills your browser needs -->
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=Promise"></script>
    <!-- Alternatively, use polyfills hosted on the Box CDN
    <script src="https://cdn01.boxcdn.net/polyfills/bluebird/3.5.1/bluebird.min.js"></script>
    -->
    

    <script src="https://cdn01.boxcdn.net/polyfills/core-js/2.5.3/core.min.js"></script>
    <script src="https://cdn01.boxcdn.net/platform/preview/2.6.1/en-US/preview.js"></script>
    <link rel="stylesheet" href="https://cdn01.boxcdn.net/platform/preview/2.6.1/en-US/preview.css" />
    

    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="config.json"></script>
    <script type="text/javascript" src="js/box.js"></script>
</head>

<body>
    <div class="preview-container" style="height:90vh; width:100vw; align:center;"></div>
    <script>
        var pageData = getPageData();
        var boxId = pageData.boxId;

        var preview = new Box.Preview();
        getAccessToken().then(function (result) {
            $.ajax({
                url: "https://api.box.com/oauth2/token",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                type: 'post',
                data: {
                    "subject_token": result,
                    "subject_token_type": "urn:ietf:params:oauth:token-type:access_token",
                    "scope": "base_explorer annotation_edit",
                    "resource": "https://api.box.com/2.0/files/" + boxId,
                    "grant_type": "urn:ietf:params:oauth:grant-type:token-exchange"
                },
                success: function (response) {
                    console.log("accessToken:" + response.access_token);
                    preview.show(boxId, response.access_token, {
                        container: '.preview-container',
                        logoUrl: 'img/custom/logo-small.png',
                        showDownload: 'false',
                        header: 'dark',
                        showAnnotations: 'true'
                       
                    })
                },
                error: function (xhr, status, error) {
                    console.log(JSON.stringify(xhr));
                    console.log("error:" + xhr.responseText);

                }
            });
        });
    </script>
</body>

</html>